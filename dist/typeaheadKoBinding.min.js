ko.typeaheadDatumGenerate=function(e,t,n,r,i){if(!e)return null;r=r||"value";if(r=="data")$.error("The name 'data' is reserved by tha bndnghandler and cannot be used as 'valueKey'");i=i||"name";if(i=="data")$.error("The name 'data' is reserved by tha bndnghandler and cannot be used as 'nameKey'");var s={};var o=[];var u=[];var a=n.split(",");if(!t){u.push(r);if(r!=i)u.push(r)}else u=t.split(",");s[r]=ko.unwrap(e[r]);s[i]=ko.unwrap(e[i]);s["data"]=e;for(var f=0;f<a.length;f++){if(a[f].trim()=="data")$.error("The name 'data' is reserved by tha bndnghandler and cannot be used in 'valueFields'");s[a[f].trim()]=ko.unwrap(e[a[f].trim()])}for(var f=0;f<u.length;f++)if(u[f].trim()){var l=ko.unwrap(e[u[f].trim()]);if(l){var c=false;for(var h=0;h<o.length;h++)if(o[h]==l){c=true;break}if(!c)o.push(ko.unwrap(e[u[f].trim()]))}}s["tokens"]=o;return s};ko.typeaheadPreFilter=function(e,t,n,r,i,s){var o;var u;if(s&&typeof s=="function"){o=s(e);u=ko.unwrap(o)}else u=ko.unwrap(e);var a=[];if(u){for(var f=0;f<u.length;f++)a.push(ko.typeaheadDatumGenerate(u[f],t,n,r,i))}return a};ko.bindingHandlers.typeahead={update:function(e,t,n,r,i){var s=t();var o=ko.unwrap(s.valueKey);var u=ko.unwrap(s.nameKey)||o;var a=ko.unwrap(s.tokenFields)||"";var f=ko.unwrap(s.valueFields)||"";if(s.hasOwnProperty("selectedDatum")){if(e&&typeof $(e).typeahead=="function"){var l=ko.unwrap(s.selectedDatum);var c=ko.typeaheadDatumGenerate(l,a,f,o,u);var h=$(e).typeahead("getDatum");if(h&&l&&o){if(h[o]!=c[o])$(e).typeahead("setDatum",c);else{if($(e).val()!=c[u])$(e).val(c[u])}}else if(h||c)$(e).typeahead("setDatum",c)}}},init:function(e,t,n,r,i){function bt(e,t){if(e.selectedDatum&&t&&t.hasOwnProperty("data"))e.selectedDatum(t.data);else e.selectedDatum(null)}var s=t();if(!$.isArray(s)){s=[s]}var o=[];var u,a,f,l,c,h,p,d;var v=s.length;for(var m=0;m<v;m++){g=s[m];var g=t();var y=ko.unwrap(g.name);var b=ko.unwrap(g.minLength);var w=ko.unwrap(g.valueKey);var E=ko.unwrap(g.nameKey)||w;var S=ko.unwrap(g.cacheKey);var x=ko.unwrap(g.skipCache);var T=ko.unwrap(g.limit);var N=g.restrictInputToDatum;var C=ko.unwrap(g.template);var k=ko.unwrap(g.templateElement);var L=ko.unwrap(g.tokenFields)||"";var A=ko.unwrap(g.valueFields)||"";var O=ko.unwrap(g.engine);var M=ko.unwrap(g.header);var _=ko.unwrap(g.footer);var D=ko.unwrap(g.local);var P=ko.unwrap(g.matcher);var H=ko.unwrap(g.prefetch);var B=ko.unwrap(g.remote);var j=ko.unwrap(g.url);var F=ko.unwrap(g.ttl);var I=ko.unwrap(g.filter);var q=ko.unwrap(g.dataType);var R=ko.unwrap(g.cache);var U=ko.unwrap(g.timeout);var z=ko.unwrap(g.wildcard);var W=ko.unwrap(g.replace);var X=ko.unwrap(g.rateLimitFn);var V=ko.unwrap(g.rateLimitWait);var J=ko.unwrap(g.maxParallelRequests);var K=ko.unwrap(g.beforeSend);var Q=ko.unwrap(g.handler);var G=ko.unwrap(g.prefetchHandler);u=g.selectedDatum;a=g.isBusy;f=ko.unwrap(g.onAutoCompleted);l=ko.unwrap(g.onSelected);h=ko.unwrap(g.onOpened);p=ko.unwrap(g.onClosed);d=ko.unwrap(g.onInitialized);c=ko.unwrap(g.onNoSelect);var Y={};if(y)Y.name=y;if(w)Y.valueKey=w;if(!w)$.error("The 'valueKey' opton is requied by this binding handler!");if(E)Y.nameKey=E;if(N)Y.restrictInputToDatum=N;if(S)Y.cacheKey=S;if(T)Y.limit=T;if(b||b===0)Y.minLength=b;if(k)Y.template=$(k).html();else if(C)Y.template=C;if(O)Y.engine=O;if(M)Y.header=M;if(_)Y.footer=_;if(D)Y.local=ko.typeaheadPreFilter(D,L,A,w,E,I);if(P)Y.matcher=P;if(H||G){var Z=null;var et={};function tt(e){return ko.typeaheadPreFilter(e,L,A,w,E,Z)}if(G)et.prefetchHandler=G;else if(typeof H=="function")et.prefetchHandler=H;else if(typeof H=="string"||typeof H=="object"&&H.constructor===String)et.url=H;else if(typeof H=="object"){var nt=ko.unwrap(H.url);var rt=ko.unwrap(H.ttl);var it=ko.unwrap(H.prefetchHandler);var st=ko.unwrap(H.skipCache);Z=ko.unwrap(H.filter);if(it)et.prefetchHandler=it;else if(nt)et.url=nt;if(rt)et.ttl=rt;if(st||st===false)et.skipCache=st}if(I&&!Z)Z=I;if(G&&!et.prefetchHandler&&!et.url)et.prefetchHandler=G;if(j&&!et.url)et.url=j;if(F&&!et.ttl)et.ttl=F;if(x&&!(et.skipCache||et.skipCache===false))et.skipCache=x;et.filter=tt;Y.prefetch=et}if(B||Q){var ot={};var Z=null;if(B&&typeof B=="function")ot.handler=B;else if(Q||typeof Q=="function")ot.handler=Q;else if(Q)ot.url=Q;else if(typeof B=="string"||typeof B=="object"&&B.constructor===String)ot.url=B;else if(typeof B=="object"){var nt=ko.unwrap(B.url);var it=ko.unwrap(B.handler);var ut=ko.unwrap(B.url);var at=ko.unwrap(B.cache);var ft=ko.unwrap(B.cacheKey);var lt=ko.unwrap(B.skipCache);var ct=ko.unwrap(B.timeout);var ht=ko.unwrap(B.wildcard);var pt=ko.unwrap(B.replace);var dt=ko.unwrap(B.rateLimitFn);var vt=ko.unwrap(B.rateLimitWait);var mt=ko.unwrap(B.maxParallelRequests);var gt=ko.unwrap(B.beforeSend);Z=ko.unwrap(B.filter);if(nt)ot.url=nt;if(ut)ot.dataType=ut;if(at)ot.cache=at;if(at)ot.cacheKey=ft;if(lt||lt===false)ot.skipCache=lt;if(ct)ot.timeout=ct;if(ht)ot.wildcard=ht;if(pt)ot.replace=pt;if(dt)ot.rateLimitFn=dt;if(vt)ot.rateLimitWait=vt;if(mt)ot.maxParallelRequests=mt;if(gt)ot.beforeSend=gt;if(I&&!Z)Z=I}function yt(e){return ko.typeaheadPreFilter(e,L,A,w,E,Z)}if(j&&!ot.url)ot.url=j;if(Q&&!ot.handler)ot.handler=Q;if(q&&!ot.url)ot.dataType=q;if(R&&!ot.url)ot.cache=R;if(S&&!ot.cacheKey)ot.cacheKey=S;if((x||x===false)&&!ot.skipCache&&ot.skipCache!==false)ot.skipCache=x;if(U&&!ot.timeout)ot.timeout=U;if(z&&!ot.wildcard)ot.wildcard=z;if(W&&!ot.replace)ot.replace=W;if(X&&!ot.rateLimitFn)ot.rateLimitFn=X;if(V&&!ot.rateLimitWait)ot.rateLimitWait=V;if(J&&!ot.maxPerallelRequests)ot.maxParallelRequests=J;if(K&&!ot.beforeSend)ot.beforeSend=K;ot.filter=yt;Y.remote=ot}if(!y)Y.name=e.id;if(Y.template&&!Y.engine&&Hogan)Y.engine=Hogan;Y.tracer=[];o.push(Y)}$(e).attr("autocomplete","off");$(e).typeahead(o);if(f)$(e).on("typeahead:autocompleted",f);if(l)$(e).on("typeahead:selected",l);if(h)$(e).on("typeahead:opened",h);if(p)$(e).on("typeahead:closed",p);if(d)$(e).on("typeahead:initialized",d);if(c)$(e).on("typeahead:noSelect",c);if(u){$(e).on("typeahead:autocompleted typeahead:selected",function(e,n){bt(t(),n)});$(e).on("typeahead:noSelect",function(e,n){bt(t(),null)})}if(a){$(e).on("typeahead:busyUpdate",function(e,n){t().isBusy(n)})}}};
